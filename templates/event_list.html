{% extends 'include/main_base.html' %}
{% block right %}
<div>
	<h3>活动列表</h3>
</div>
<div class="row" style="padding:10px">
	<a class="btn btn-primary" data-moveable="true" data-iframe="{% url 'event_create' %}" data-toggle="modal">创建活动</a>
	<div class="col-lg-3" style="float: right;">
	    <div class="input-group">
	      <input type="text" class="form-control" placeholder="Search for..." id="searchInput">
	      <span class="input-group-btn">
	        <button class="btn btn-default" type="button" onclick="search()">搜索</button>
	      </span>
	    </div>
    </div>
</div>
<table class="table datatable">
	<thead>
		<tr>
			<th>序号</th>
			<th>活动名称</th>
			<th>公测时间</th>
			<th>活动时间</th>
			<th>认筹名单</th>
			<th>车位房源</th>
			<th>活动状态</th>
			<th>二维码</th>
			<th>操作</th>
		</tr>
	</thead>
	<tbody>
		{% for obj in object_list %}
		<tr>
			<td>{{ forloop.counter }}</td>
			<td>{{ obj.name }}</td>
			<td><p>{{ obj.test_start }}</p>
			<p>至</p>
			<p>{{ obj.test_end }}</p></td>
			<td><p>{{ obj.event_start }}</p>
			<p>至</p>
			<p>{{ obj.event_end }}</p></td>
			<td><a href="{% url 'event_customs' pk=obj.id %}">{{ obj.customer_set.count }} <i class='icon-edit'></i></a></td>
			<td><a href="{% url 'room_list' pk=obj.id %}">{{ obj.eventdetail_set.count }} <i class='icon-edit'></i></a></td>
			<td>TODO</td>
			<td>qr</td>
			<td>
				<p><a data-iframe="{% url 'event_detail' pk=obj.id %}" data-toggle="modal" data-title="活动详情">查看</a></p>
				<p><a data-toggle="modal" data-target="#deleteIssue">{% if obj.is_pub == False %}发布{% else %}取消发布{% endif %}</a></p>
				<p><a data-iframe="{% url 'event_update' pk=obj.id %}" data-toggle="modal">编辑活动</a></p>
				<p><a data-iframe="{% url 'event_term_update' pk=obj.id %}" data-toggle="modal">编辑协议</a></p>
				<p><a data-toggle="modal" data-target="#deleteModal">清除公测名单</a></p>
			</td>
		</tr>
		<!--取消发布-->
		<div class="modal fade" id="deleteIssue">
		  <div class="modal-dialog modal-sm">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span></button>
		        <h4 class="modal-title">取消发布</h4>
		      </div>
		      <div class="modal-body">
		        <p>确认取消发布？</p>
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
		        <button type="button" class="btn btn-primary" onclick="Unpublish({{obj.id}})">确认</button>
		      </div>
		    </div>
		  </div>
		</div>
		<!--清除公测名单-->
		<div class="modal fade" id="deleteModal">
		  <div class="modal-dialog modal-sm">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span></button>
		        <h4 class="modal-title">清除公测名单</h4>
		      </div>
		      <div class="modal-body">
		        <p>确认清除公测名单？</p>
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
		        <button type="button" class="btn btn-primary" onclick="deleteOrder({{obj.id}})">确认</button>
		      </div>
		    </div>
		  </div>
		</div>
		{% endfor %}
	</tbody>
</table>
{% endblock %}
{% block js %}
<script type="text/javascript">
$(document).ready(function(){ $('table.datatable').datatable({ sortable: true, }); });
</script>
{% endblock %}
